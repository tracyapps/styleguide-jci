<?php
// sidenav for the styleguide.
?>

<nav class="styleguide_sidenav">
	<div class="branding-container">
		<div class="logo">
			<a href="<?php bloginfo( 'home' ); ?>">
			<svg version="1.1" id="jcilogo" xmlns="http://www.w3.org/2000/svg"
				 xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
				 viewBox="0 0 370.4 162.3" style="enable-background:new 0 0 370.4 162.3;" xml:space="preserve">
					<style type="text/css">
						.st0 {
							fill: #FFFFFF;
						}
					</style>
				<g id="controls">
					<path class="st0" d="M62.5,161.8c-13,0-21.9-9-21.9-22c0-12.6,7.9-22.1,20.9-22.1c4,0,8.7,1.3,12.3,2.9l-2.6,6.4
							c-3.1-1.4-6.4-2.4-9.9-2.4c-8.2,0-12.4,6.9-12.4,14.5c0,9.1,4.9,15.9,14.5,15.9c2.9,0,5.8-0.8,8.4-2l2,6
							C70.4,160.7,66.5,161.8,62.5,161.8z"/>
					<path class="st0" d="M90.8,161.9c-9.6,0-15.7-7-15.7-16.3c0-9.3,6.1-16.3,15.7-16.3c9.6,0,15.7,6.9,15.7,16.3
							C106.5,154.9,100.4,161.9,90.8,161.9z M90.8,135.7c-5.6,0-7.4,5.1-7.4,9.9c0,4.8,1.8,9.8,7.4,9.8c5.6,0,7.4-5.1,7.4-9.8
							C98.2,140.9,96.3,135.7,90.8,135.7z"/>
					<path class="st0" d="M131,161.2v-19.6c0-3.8-2.5-5.8-6.2-5.8c-2.1,0-4.3,0.6-6.3,1.4c0,0,0.1,0.9,0.1,1.3l0,22.7h-7.5v-24.5
							c0-1.5-0.4-4.4-0.4-4.4c4.4-1.6,9.6-3.1,14.2-3.1c7.6,0,13.6,2.5,13.6,11.1v20.8H131z"/>
					<path class="st0" d="M155.8,162.3c-5.7,0-9.6-2.6-9.6-8.7v-17.3l-3.6-0.2v-5.9l3.6-0.2v-8.7h7.5v8.6h8.8v6.5h-8.8v16.6
							c0,1.9,1,2.7,2.9,2.7c1.9,0,3.8-0.6,5.6-1.3l2.1,6.1C161.4,161.5,158.7,162.3,155.8,162.3z"/>
					<path class="st0" d="M184.8,136.3c-1-0.3-2.8-0.6-4.1-0.6c-1.9,0-3.8,0.3-5.6,0.8c0,0,0.1,0.4,0.1,0.6v24h-7.5v-23.8
							c0-1.6-0.6-4.7-0.6-4.7c4.5-1.9,9.3-3.5,14.3-3.5c1.9,0,4.1,0.3,5.7,0.7L184.8,136.3z"/>
					<path class="st0" d="M202.4,161.9c-9.6,0-15.7-7-15.7-16.3c0-9.3,6.1-16.3,15.7-16.3c9.6,0,15.7,6.9,15.7,16.3
							C218.1,154.9,212,161.9,202.4,161.9z M202.4,135.7c-5.6,0-7.4,5.1-7.4,9.9c0,4.8,1.8,9.8,7.4,9.8c5.6,0,7.4-5.1,7.4-9.8
							C209.8,140.9,208,135.7,202.4,135.7z"/>
					<polygon class="st0" points="230.2,115.3 222.7,115.3 222.7,148.1 222.7,161.2 230.2,161.2 	"/>
					<path class="st0" d="M244.8,161.9c-3.6,0-7.2-0.9-10.3-2.1l2.2-5.9c2.2,0.9,5.1,1.9,7.5,1.9c2.3,0,4.7-0.7,4.7-3.4
							c0-5.6-13.6-3.9-13.6-14.1c0-6.4,6.6-9,11.6-9c3.3,0,6.6,0.8,9,1.9l-2.1,5.8c-2-0.8-4.8-1.4-6.9-1.4c-1.9,0-3.9,0.6-3.9,2.8
							c0,5.3,14.3,2.9,14.3,14.2C257.2,159.4,250.5,161.9,244.8,161.9z"/>
				</g>
				<g id="johnson">
					<g>
						<path class="st0" d="M8.2,108.8c-1.8,0.6-4.5,1.4-6.8,2L0,104c1.5-0.3,3.4-0.7,4.7-1.1c4.3-1.5,4.7-4.6,4.7-9.7V61.3h7.8V92
								C17.1,100.4,15.9,106,8.2,108.8z"/>
					</g>
					<path class="st0" d="M37.5,104.4c-9.6,0-15.7-7-15.7-16.3c0-9.3,6.1-16.3,15.7-16.3c9.6,0,15.7,6.9,15.7,16.3
							C53.2,97.5,47.1,104.4,37.5,104.4z M37.5,78.3c-5.6,0-7.4,5.1-7.4,9.9c0,4.8,1.8,9.8,7.4,9.8c5.6,0,7.4-5.1,7.4-9.8
							C44.9,83.5,43.1,78.3,37.5,78.3z"/>
					<path class="st0" d="M78.1,103.7V84c0-3.4-2.1-5.7-5.2-5.7c-2.5,0-5.1,1.1-7.2,2.3v23.1h-7.5l0-45.9h7.5v16
							c2.9-1.2,6.1-2.1,9.3-2.1c7,0,10.7,4.1,10.7,11.1v20.9H78.1z"/>
					<path class="st0" d="M111.8,103.7V84.1c0-3.8-2.5-5.8-6.2-5.8c-2.1,0-4.3,0.6-6.3,1.4c0,0,0.1,0.9,0.1,1.3v22.7H92V79.3
							c0-1.5-0.4-4.4-0.4-4.4c4.4-1.6,9.6-3.1,14.2-3.1c7.6,0,13.6,2.5,13.6,11.1v20.8H111.8z"/>
					<path class="st0" d="M134,104.4c-3.6,0-7.2-0.9-10.3-2.1l2.2-5.9c2.2,0.9,5.1,1.9,7.5,1.9c2.3,0,4.8-0.7,4.8-3.4
							c0-5.6-13.6-3.9-13.6-14.2c0-6.4,6.6-9,11.6-9c3.3,0,6.6,0.8,9,1.9l-2.1,5.8c-2-0.8-4.8-1.5-6.9-1.5c-1.9,0-3.9,0.6-3.9,2.8
							c0,5.3,14.3,2.9,14.3,14.2C146.5,102,139.7,104.4,134,104.4z"/>
					<path class="st0" d="M165.5,104.4c-9.6,0-15.7-7-15.7-16.3c0-9.3,6.1-16.3,15.7-16.3c9.6,0,15.7,6.9,15.7,16.3
							C181.2,97.5,175.1,104.4,165.5,104.4z M165.5,78.3c-5.6,0-7.4,5.1-7.4,9.9c0,4.8,1.8,9.8,7.4,9.8c5.6,0,7.4-5.1,7.4-9.8
							C172.9,83.5,171.1,78.3,165.5,78.3z"/>
					<path class="st0" d="M206,103.7V84.1c0-3.8-2.5-5.8-6.2-5.8c-2.1,0-4.3,0.6-6.3,1.4c0,0,0.1,0.9,0.1,1.3v22.7h-7.5V79.3
							c0-1.5-0.4-4.4-0.4-4.4c4.4-1.6,9.5-3.1,14.2-3.1c7.6,0,13.6,2.5,13.6,11.1v20.8H206z"/>
				</g>
				<g id="globe">
					<path class="st0" d="M253.9,52.9c8.2-8.3,14.9-24.6,16.7-35.8C261.2,26.4,255.1,39,253.9,52.9z"/>
					<path class="st0" d="M282.4,7.8c-0.5,0.3-0.9,0.6-1.4,0.8c-6.1,28.7-11.7,41.3-26.6,58.8c0.3,2.1,0.8,4.2,1.3,6.2
						C278.5,59.5,284.1,26.7,282.4,7.8z"/>
					<path class="st0" d="M329.4,46.5c-0.7-17-3.9-32.4-9.3-45.8L320,0.3c-0.7-0.1-1.4-0.2-2.1-0.2c4.8,41,3.7,83.5-25.6,113
						c4.1,1.5,8.4,2.5,12.8,3C321.8,101.4,330.7,76.4,329.4,46.5z"/>
					<path class="st0" d="M307.1,0c-0.7,0.1-1.4,0.1-2.1,0.2l0,0c1,26.6-0.5,74.4-32.1,101.3c2.2,1.9,4.5,3.7,6.9,5.3l0,0
						C313.2,84.1,317.9,37.7,307.1,0z"/>
					<path class="st0" d="M294.2,2.5c-0.6,0.2-1.2,0.4-1.7,0.6c-1.9,33.7-8.1,60.9-32,82.6c1.2,2.2,2.5,4.3,3.9,6.3
						C294.8,73.5,300.1,28.6,294.2,2.5z"/>
					<path class="st0"
						  d="M369,45.6c-8.6,7.9-13,29.3-6.1,41.1c4.8-8.5,7.5-18.2,7.5-28.6C370.4,53.9,369.9,49.7,369,45.6z"/>
					<path class="st0" d="M363.7,30.9c-0.4-0.7-0.8-1.5-1.2-2.2c-13.3,7.5-21.7,20.1-23,34.8c-1.2,13.3,4,26.7,13.8,36
						c1.1-1.1,2.2-2.3,3.3-3.6C344.7,73,347.2,50.5,363.7,30.9z"/>
					<path class="st0" d="M327.9,95.4c3.5,4.8,8,9.3,13.5,13.2c1.3-0.8,2.6-1.6,3.9-2.5c-5.9-8-9.8-16.8-11.9-26.5
						C332.1,85.2,330.2,90.5,327.9,95.4z"/>
					<path class="st0" d="M335.9,44c3.9-10.6,10.6-20.4,18.1-26.3c-0.6-0.6-1.2-1.2-1.8-1.8c-6.9,3.4-13.1,7.7-18.4,12.8
						C334.9,33.9,335.6,39,335.9,44z"/>
					<path class="st0" d="M331,17.1c3.7-4.3,6.7-7.5,9.4-10c-0.6-0.4-1.3-0.7-1.9-1c-2.8,1.2-6.5,3-9.4,4.7
						C329.8,12.9,330.4,15,331,17.1z"/>
					<path class="st0" d="M318.8,109.7c1.8,1.6,4.6,3.8,6.7,5.3c1.8-0.4,3.5-0.9,5.2-1.5c-2.6-2.9-5.1-6.5-7.4-9.8
						C321.9,105.8,320.4,107.8,318.8,109.7z"/>
				</g>
			</svg>
			</a>
		</div>

	</div>
	<ul class="page-tree">

		<?php // start_side_nav(); // the WP nav menu (manual control) ?>
		<?php

		$sidemenucategories = get_categories('taxonomy=category');
		$sidemenucategories_sorted = array();

		foreach( $sidemenucategories as $cat ) {
			$the_order = get_field( 'menu_order', $cat );
			$sidemenucategories_sorted[$the_order] = $cat;
		}

		//sort the list ASC
		ksort($sidemenucategories_sorted);
		//print_r( $sidemenucategories_sorted );

		foreach( $sidemenucategories_sorted as $display_cat ) {

			if( get_field( 'display_in_main_nav', 'category_' . $display_cat->term_id  )
				&& ( 1 == $display_cat->category_count ) ) :
			// if "display in nav" is checked, and there is only one component in the category
			$postargs = array(
				'category'		=>	$display_cat->term_id,
				'post_type'		=> 'component',
			);
			$components_in_category = get_posts( $postargs );
			foreach( $components_in_category as $single_component ) :
				$component_permalink = get_permalink( $single_component->ID );

				printf(
					'<li id="page-id-%s" class="menu-item component-menu-item page-id-%s %s" data-node="#%s">
							<span class="nav_item_text_wrap"> 
								<a href="%s">%s</a>
							</span> 
						</li>',
					intval( $single_component->ID ),
					intval( $single_component->ID ),
					is_single( $single_component->ID ) ? 'current-menu-item' : '',
					intval( $single_component->ID ),
					esc_url( $component_permalink ),
					esc_html( $display_cat->name )
				);
			endforeach;

			elseif( get_field( 'display_in_main_nav', 'category_' . $display_cat->term_id  )
					&& ( 1 != $display_cat->category_count ) ) :
			// if "display in nav" is checked, and there are multiple components in the category
				printf(
					'<li id="page-id-%s" class="menu-item component-menu-item page-id-%s %s menu-item-has-children" data-node="#%s">
							<span class="nav_item_text_wrap"> 
								<a href="%s">%s</a> 
								<span class="open_close"><svg class="svg-inline--fa fa-chevron-down fa-w-14" aria-hidden="true" data-prefix="far" data-icon="chevron-down" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M441.9 167.3l-19.8-19.8c-4.7-4.7-12.3-4.7-17 0L224 328.2 42.9 147.5c-4.7-4.7-12.3-4.7-17 0L6.1 167.3c-4.7 4.7-4.7 12.3 0 17l209.4 209.4c4.7 4.7 12.3 4.7 17 0l209.4-209.4c4.7-4.7 4.7-12.3 0-17z"></path></svg><!-- <i class="far fa-chevron-down"></i> --></span>
							</span> 
						<ul class="children">',
					intval( $display_cat->term_id ),
					intval( $display_cat->term_id ),
					is_category( $display_cat->term_id ) ? 'current-menu-item' : '',
					intval( $display_cat->term_id ),
					esc_url( get_term_link( $display_cat ) ),
					esc_html( $display_cat->name )
				);

				$postargs = array(
					'category'		=>	$display_cat->term_id,
					'post_type'		=> 'component',
					'order_by'		=> 'menu_order',
					'order'			=> 'ASC',
				);
				$components_in_category = get_posts( $postargs );
				foreach( $components_in_category as $single_component ) :
					$component_permalink = get_permalink( $single_component->ID );
					printf(
						'<li id="page-id-%s" class="menu-item component-menu-item page-id-%s %s" data-node="#%s">
							<span class="nav_item_text_wrap"> 
								<a href="%s">%s</a>
							</span> 
						</li>',
						intval( $single_component->ID ),
						intval( $single_component->ID ),
						is_single( $single_component->ID ) ? 'current-menu-item' : '',
						intval( $single_component->ID ),
						esc_url( $component_permalink ),
						esc_html( $single_component->post_title )
					);
				endforeach;

				echo '</ul></li>';

			else :
				//crickets
			endif;
		}



		/*if ( $sidemenucategories->have_posts() ) {
			// The Loop
			while ( $sidemenucategories->have_posts() ) {
				$sidemenucategories->the_post();
				echo '<li>' . get_the_title() . '</li>';
			}

			wp_reset_postdata();
		}*/
		?>


	</ul>
</nav>
